<!DOCTYPE html>
<html>
<head>
  <title>schema doc homepage</title>
  <!-- Includes all JS & CSS for the JavaScript Data Grid -->
  <script src="https://cdn.jsdelivr.net/npm/ag-grid-community/dist/ag-grid-community.min.js"> </script>
</head>
<body>
  <h2>頁面清單</h2>
  <div id="table" style="height: 500px; width: 100%;"></div>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    const data = <%- tableData %>;

    // 處理你的 data，加超連結跟 markdown
    const rowData = data.map(row => ({
      folder: row.folder,
      type: row.type,
      path: row.path,
      description: marked.parse(row.description || '')
    }));

    // ag-Grid 欄位定義
    const columnDefs = [
      { headerName: 'folder', field: 'folder', sortable: true, filter: true },
      { headerName: 'type', field: 'type', sortable: true, filter: true },
      { headerName: 'path', field: 'path', sortable: true, filter: true,
        cellRenderer: params => {
          const url = window.location.origin + (params.value.startsWith('/') ? params.value : '/' + params.value);
          return `<a href="${url}">${params.value}</a>`;
        }
      },
      { headerName: 'description', field: 'description', flex: 1, autoHeight: true,
        cellRenderer: params => params.value 
      }
    ];

    // 建立 grid
    const gridOptions = {
      columnDefs,
      rowData,
      defaultColDef: {
        resizable: true, sortable: true, filter: true
      }
    };

    // render
    agGrid.createGrid(document.getElementById('table'), gridOptions);
    </script>
</body>
</html>